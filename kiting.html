<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·¹í•œì˜ ì¹´ì´íŒ… íŠ¸ë ˆì´ë„ˆ - LOLPhysical.xyz</title>
    <style>
        body { margin: 0; background-color: #121212; color: #e0e0e0; font-family: 'Pretendard', 'Apple SD Gothic Neo', sans-serif; line-height: 1.6; user-select: none; overflow-x: hidden; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 15px 20px; display: flex; flex-direction: column; align-items: center; }
        header { text-align: center; margin-bottom: 10px; width: 100%; position: relative; }
        h1 { color: #ff3366; text-shadow: 0 0 15px rgba(255, 51, 102, 0.4); margin: 0; font-size: 2rem; }
        .subtitle { color: #aaa; font-size: 0.95rem; margin-top: 3px; }
        
        .nav-menu { margin-top: 8px; display: flex; gap: 15px; justify-content: center; align-items: center; }
        .nav-btn { background: #222; color: #fff; border: 1px solid #444; padding: 6px 18px; border-radius: 20px; text-decoration: none; font-weight: bold; transition: 0.2s; font-size: 15px; }
        .nav-btn:hover { background: #333; border-color: #00ffcc; color: #00ffcc; }
        .nav-btn.active { background: #ff3366; color: #fff; border-color: #ff3366; box-shadow: 0 0 10px rgba(255, 51, 102, 0.5); }

        .status-board { text-align: center; margin-bottom: 12px; z-index: 10; }
        .score-board { font-size: 22px; font-weight: 800; color: #fff; text-shadow: 2px 2px 0px #000; margin-bottom: 3px; }
        .best-score { font-size: 14px; color: #ffd700; font-weight: bold; text-shadow: 1px 1px 2px #000; margin-bottom: 3px; }
        .tier-badge { display: inline-block; padding: 4px 12px; border-radius: 15px; background-color: #333; color: #fff; font-weight: bold; font-size: 14px; border: 1px solid #555; box-shadow: 0 0 10px rgba(0,0,0,0.5); }

        .game-area { 
            position: relative; margin: 0 auto 40px auto; width: fit-content; 
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.8); border-radius: 4px; overflow: hidden; background-color: #0a0a0c; border: 2px solid #333; cursor: crosshair; 
        }
        canvas { display: block; background: radial-gradient(circle at center, #1a1a20 0%, #0a0a0c 100%); }

        .message-box {
            background-color: rgba(0, 0, 0, 0.92); padding: 35px; border-radius: 15px; border: 1px solid #444;
            position: absolute; top: 42%; left: 50%; transform: translate(-50%, -50%);
            box-shadow: 0 0 30px rgba(0,0,0,0.8); min-width: 320px; text-align: center; z-index: 20;
        }

        .input-group { margin: 15px 0; display: flex; gap: 10px; justify-content: center; width: 100%; }
        select { background: #222; border: 1px solid #555; color: #fff; padding: 10px; border-radius: 5px; font-size: 15px; font-weight: bold; cursor: pointer; }
        input[type="text"] { background: #222; border: 1px solid #555; color: #fff; padding: 10px; border-radius: 5px; font-size: 15px; text-align: center; width: 160px; }
        select:focus, input[type="text"]:focus { outline: none; border-color: #ff3366; }

        .btn { background: #00ffcc; color: #000; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 15px; margin-top: 10px; transition: 0.2s; }
        .btn:hover { background: #00dbaf; transform: scale(1.05); }
        .btn-outline { background: transparent; border: 1px solid #00ffcc; color: #00ffcc; }
        .btn-outline:hover { background: rgba(0, 255, 204, 0.1); }
        
        .highlight { color: #ff3366; font-weight: bold; }
        .highlight-blue { color: #00ffcc; font-weight: bold; }

        .content-section { background-color: #1a1a1d; padding: 40px; border-radius: 15px; max-width: 800px; width: 100%; box-sizing: border-box; margin-top: 20px; }
        h2 { color: #f0e6d2; border-bottom: 1px solid #333; padding-bottom: 15px; margin-top: 40px; }
        h3 { color: #ccc; margin-top: 25px; }
        p, ul { color: #b0b0b0; }
        
        .science-board { margin-top: 40px; background-color: #111; border: 1px solid #333; border-radius: 8px; padding: 20px; }
        .science-board h3 { margin-top: 0; color: #00ffcc; border-bottom: none; padding-bottom: 0; font-size: 1.3rem; }
        .article-list { list-style: none; padding: 0; margin: 0; }
        .article-list li { border-bottom: 1px solid #222; padding: 12px 0; display: flex; justify-content: space-between; align-items: center; }
        .article-list li:last-child { border-bottom: none; }
        .article-list a { color: #e0e0e0; text-decoration: none; font-size: 15px; transition: color 0.2s; display: block; flex-grow: 1; }
        .article-list a:hover { color: #00ffcc; text-decoration: underline; }
        .badge-ready { background: #333; color: #888; font-size: 12px; padding: 3px 8px; border-radius: 12px; white-space: nowrap; margin-left: 10px;}

        .comment-section { margin-top: 50px; width: 100%; max-width: 800px; padding: 20px; background: #1a1a1d; border-radius: 10px; }
        footer { margin-top: 60px; padding: 30px; text-align: center; font-size: 13px; color: #666; border-top: 1px solid #222; width: 100%; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>ê·¹í•œì˜ ì¹´ì´íŒ… íŠ¸ë ˆì´ë„ˆ</h1>
            <div class="subtitle">íšŒí”¼ Â· ë‹¤ìˆ˜ ì  ì¹´ì´íŒ… Â· ëˆ„ì  ë”œëŸ‰ ì¸¡ì •</div>
            
            <div class="nav-menu">
                <a href="index.html" class="nav-btn" style="background: transparent; border: none; font-size: 18px; padding: 6px;">ğŸ  ë¡œë¹„</a>
                <a href="tracking.html" class="nav-btn">ë‡ŒÂ·ì† í˜‘ì‘ ì˜ˆì—´</a>
                <a href="kiting.html" class="nav-btn active">ì‹¤ì „ ì¹´ì´íŒ… í›ˆë ¨</a>
            </div>
        </header>

        <div class="status-board">
            <div class="best-score">ë‚´ ìµœê³  ëˆ„ì  ë”œëŸ‰: <span id="bestDamageVal">0</span></div>
            <div class="score-board">ë”œëŸ‰: <span id="damageVal">0</span> | ìƒì¡´: <span id="timeVal">0.0</span>ì´ˆ | ëª©ìˆ¨: <span id="lifeVal" style="color:#ff3333;">1</span></div>
            <div class="tier-badge" id="tierBadge">UNRANKED</div>
        </div>

        <div class="game-area">
            <div id="startScreen" class="message-box">
                <h2 style="margin:0 0 15px 0; color:#fff;">ì†Œí™˜ì‚¬ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤</h2>
                <p style="font-size:14px; color:#aaa; margin-top:-10px; margin-bottom:15px;">
                    ì¥íŒê³¼ ìŠ¤í‚¬ì„ í”¼í•´ <span class="highlight">ìµœëŒ€í•œ ë”œì„ ìš°ê²¨ë„£ìœ¼ì„¸ìš”.</span><br>
                    (â€» Sí‚¤ë¥¼ ëˆ„ë¥´ë©´ ì¦‰ì‹œ ë©ˆì¶¥ë‹ˆë‹¤)
                </p>
                
                <div class="input-group">
                    <select id="regionSelect" style="width: 30%;">
                        <option value="KR">KR</option>
                        <option value="NA">NA</option>
                        <option value="EUW">EUW</option>
                        <option value="JP">JP</option>
                        <option value="ETC">ETC</option>
                    </select>
                    <input type="text" id="riotIdInput" placeholder="ì†Œí™˜ì‚¬ëª… (ì˜ˆ: Hide on bush#KR1)" style="width: 70%;">
                </div>
                
                <div class="input-group" style="margin-top: 5px;">
                    <select id="kitingModeSelect" style="width: 100%;">
                        <option value="A_LEFT">ì¡°ì‘: ì •í†µíŒŒ (A ì¥ì „ + ì¢Œí´ë¦­)</option>
                        <option value="A_ONLY">ì¡°ì‘: ìŠ¤ë§ˆíŠ¸í‚¤ (A ì¦‰ì‹œ ì‹œì „)</option>
                        <option value="RIGHT">ì¡°ì‘: ìˆœìˆ˜ í”¼ì§€ì»¬ (ìš°í´ë¦­ ì „ìš©)</option>
                    </select>
                </div>

                <button class="btn" style="background:#ff3366; color:#fff;" onclick="startGame()">í•œíƒ€ ì°¸ì—¬ (ìŠ¤í˜ì´ìŠ¤ë°”)</button>
                <p style="font-size:13px; color:#888; margin-top:15px;">*ì…ë ¥í•œ IDëŠ” ê²°ê³¼ í™”ë©´ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
            </div>

            <div id="gameOverScreen" class="message-box" style="display:none;">
                <h2 style="margin:0 0 10px 0; color:#ff5555;">GAME OVER</h2>
                <p style="font-size:18px; color:#fff;">
                    <span id="resultId" style="color:#ff3366; font-weight:bold;"></span> ë‹˜ì˜ ê²°ê³¼<br>
                    ëˆ„ì  ë”œëŸ‰: <span id="resultDamage" style="font-size:28px; font-weight:bold;">0</span> (<span id="resultTime" style="color:#00ffcc;">0</span>ì´ˆ ìƒì¡´)
                </p>
                <div id="resultTier" style="margin-bottom:20px; font-size:24px; font-weight:bold;"></div>
                
                <button class="btn" onclick="copyResult()">ğŸ“‹ ê²°ê³¼ ë³µì‚¬í•´ì„œ íŒ©íŠ¸ í­ê²©í•˜ê¸°</button>
                <button class="btn btn-outline" style="border-color:#ff3366; color:#ff3366;" onclick="restartGame()">ë‹¤ì‹œ ë„ì „ (ìŠ¤í˜ì´ìŠ¤ë°”)</button>
            </div>

            <canvas id="gameCanvas" width="900" height="600"></canvas>
        </div>

        <div class="comment-section">
            <h3 style="text-align:center; color:#ccc;">ëª…ì˜ˆì˜ ì „ë‹¹ & ë°©ëª…ë¡</h3>
            <p style="text-align:center; font-size:14px; color:#666; margin-bottom:20px;">ìì‹ ì˜ ì§„ì§œ í”¼ì§€ì»¬ì„ ë°•ì œí•˜ê³  ì¹œêµ¬ ì¶”ê°€ë¥¼ í•´ë³´ì„¸ìš”.</p>
            <div id="utterances-container">
                <script src="https://utteranc.es/client.js" repo="parkkyusang/lolphysical" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async></script>
            </div>
        </div>

        <article class="content-section">
            <h2>íŒ©íŠ¸ í­ê²©: ë‹¹ì‹ ì˜ ì§„ì§œ í‹°ì–´ëŠ”?</h2>
            <p>ìƒëŒ€ ì±”í”¼ì–¸ì€ ê°€ë§Œíˆ ì„œì„œ ë§ì•„ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¨¸ë¦¬ë¡œëŠ” ì´ë¯¸ ì±Œë¦°ì €ì¸ë° ìŠ¤í‚¬ì„ í”¼í•˜ì§€ ëª»í•´ íšŒìƒ‰ í™”ë©´ì„ ë³´ê³  ê³„ì‹ ê°€ìš”?<br>
            ì´ íŠ¸ë ˆì´ë„ˆëŠ” í•‘ê³„ ëŒˆ ìˆ˜ ì—†ëŠ” ìˆ«ìë¡œ ë‹¹ì‹ ì˜ ì§„ì§œ ì¹´ì´íŒ… í˜„ì£¼ì†Œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
            
            <h3>í‹°ì–´ë³„ íŒ©íŠ¸ ì²´í¬ (ëª©í‘œ ëˆ„ì  ë”œëŸ‰)</h3>
            <ul>
                <li><span style="color:#00ffcc">CHALLENGER (12000+)</span>: ê´´ë¬¼. ì™„ë²½í•œ ê±°ë¦¬ ì¡°ì ˆê³¼ ë¬´í˜¸í¡ ë”œë§.</li>
                <li><span style="color:#f35588">GRANDMASTER (9000~11990)</span>: ì›¬ë§Œí•œ ìŠ¤í‚¬ì€ ì¶¤ì¶”ë“¯ í”¼í•˜ëŠ” ìµœìƒìœ„ í”¼ì§€ì»¬.</li>
                <li><span style="color:#d192fd">MASTER (7000~8990)</span>: ë§¤ë“œë¬´ë¹„ ì œì¡°ê¸°. í™•ì‹¤í•œ ë”œê°ê³¼ ë°˜ì‘ì†ë„.</li>
                <li><span style="color:#576bce">DIAMOND (5000~6990)</span>: í›Œë¥­í•œ í”¼ì§€ì»¬. ì•ˆì •ì ì¸ ë¬´ë¹™.</li>
                <li><span style="color:#00d26a">EMERALD (3500~4990)</span>: ì†ì€ ë¹ ë¥¸ë° ìŠ¤í‚¬ í”¼í•˜ë‹¤ê°€ ë”œì„ ëª» ë„£ëŠ” êµ¬ê°„.</li>
                <li><span style="color:#2ec4b6">PLATINUM (2500~3490)</span>: 1ì¸ë¶„ì€ í™•ì‹¤íˆ í•˜ëŠ” ì•ˆì •ì ì¸ ì¹´ì´íŒ….</li>
                <li><span style="color:#ffd700">GOLD (1500~2490)</span>: í”íˆ ë³¼ ìˆ˜ ìˆëŠ” í‰ë²”í•œ ë¬´ë¹™.</li>
                <li><span style="color:#c0c0c0">SILVER (800~1490)</span>: ì¹´ì´íŒ… í•˜ë‹¤ê°€ ë©ˆì¶°ì„œ ìŠ¤í‚¬ ë‹¤ ë§ëŠ” êµ¬ê°„.</li>
                <li><span style="color:#cd7f32">BRONZE (400~790)</span>: ì œìë¦¬ì—ì„œ í‰íƒ€ë§Œ ì¹˜ëŠ” ë§ëšë”œ ì¥ì¸.</li>
                <li><span style="color:#5a5a5a">IRON (0~390)</span>: ì ì—ê²Œ ë‹¤ê°€ê°€ì„œ ëª¸ì„ ëŒ€ì£¼ëŠ” ìë¹„ë¡œìš´ ì˜í˜¼.</li>
            </ul>
            
            <h3>ì¡°ì‘ë²• ë° ì‹¤ì „ í›ˆë ¨ ê°€ì´ë“œ</h3>
            <p>ì ë“¤ì´ ë‹¹ì‹ ì„ í–¥í•´ ëª°ë ¤ì˜µë‹ˆë‹¤. <strong>ìš°í´ë¦­(ì´ë™)</strong>ê³¼ <strong>ì–´íƒë•…(ê³µê²©)</strong>ì„ ì„ì–´ ê±°ë¦¬(Spacing)ë¥¼ ìœ ì§€í•˜ì„¸ìš”. <strong>ë³´ë¼ìƒ‰ ë©”ì´ì§€</strong>ëŠ” ë°œë°‘ì— ì¦‰ë°œí˜• ìŠ¤í‚¬(ì¥íŒ, ì§ì„  ë ˆì´ì €)ì„ ì˜ë‹ˆ <strong>Sí‚¤(ì •ì§€)</strong>ì™€ ë¬´ë¹™ìœ¼ë¡œ ì¦‰ì‹œ íšŒí”¼í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            
            <div class="science-board">
                <h3>ë‡Œê³¼í•™ê³¼ í”¼ì§€ì»¬ íŠ¸ë ˆì´ë‹ (Scientific Backing)</h3>
                <p style="font-size:14px; color:#aaa; margin-bottom:15px;">ì´ í›ˆë ¨ì´ ì–´ë–»ê²Œ ë‡Œì‹ ê²½ ê°€ì†Œì„±(Neuroplasticity)ì„ ìê·¹í•˜ê³  ì‹¤ë ¥ì„ í–¥ìƒì‹œí‚¤ëŠ”ì§€ ê³¼í•™ì  ê·¼ê±°ë¥¼ ì—°ì¬í•©ë‹ˆë‹¤.</p>
                <ul class="article-list" id="articleList"></ul>
            </div>
        </article>

        <footer>
            <p>Â© 2026 LoL Physical Trainer. All rights reserved. | <a href="privacy.html" style="color:#888; text-decoration:none;">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨(Privacy Policy)</a></p>
        </footer>
    </div>

    <script src="articles.js"></script>

    <script>
        document.addEventListener('contextmenu', event => event.preventDefault());

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const damageEl = document.getElementById('damageVal');
        const timeEl = document.getElementById('timeVal');
        const lifeEl = document.getElementById('lifeVal');
        const bestDamageEl = document.getElementById('bestDamageVal');
        const tierBadgeEl = document.getElementById('tierBadge');
        
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const riotIdInput = document.getElementById('riotIdInput');
        const regionSelect = document.getElementById('regionSelect');
        const modeSelect = document.getElementById('kitingModeSelect');

        let bestDamage = localStorage.getItem('lol_best_damage_kiting') || 0;
        bestDamageEl.innerText = bestDamage;

        let savedId = localStorage.getItem('lol_name') || "";
        let savedRegion = localStorage.getItem('lol_server') || "KR";
        let savedMode = localStorage.getItem('lol_kiting_mode') || "A_LEFT";
        
        riotIdInput.value = savedId;
        regionSelect.value = savedRegion;
        modeSelect.value = savedMode;

        let isPlaying = false;
        let totalDamage = 0;
        let survivalTime = 0;
        let startTime = 0;
        let currentMode = 'A_LEFT'; 

        let attackSpeed = 1.5; 
        let attackCooldown = 1000 / attackSpeed; 
        let lastAttackTime = 0;
        let aKeyPrimed = false; 

        let player = { x: 450, y: 300, radius: 15, speed: 3.8, attackRange: 240, destX: 450, destY: 300, isMoving: false };
        let enemies = [];
        let aoeAttacks = []; 
        let clickEffects = []; 
        let hitFeedback = []; 
        let mouse = { x: 0, y: 0 };

        function updateMousePos(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            mouse.x = (e.clientX - rect.left) * scaleX;
            mouse.y = (e.clientY - rect.top) * scaleY;
        }

        canvas.addEventListener('mousemove', updateMousePos);

        window.addEventListener('keydown', (e) => {
            const isInputFocus = (document.activeElement === riotIdInput || document.activeElement === regionSelect || document.activeElement === modeSelect);
            if (e.code === 'Space') { if (!isInputFocus) e.preventDefault(); }
            
            if (e.code === 'Space' && !isPlaying && !isInputFocus) {
                if(startScreen.style.display !== 'none') startGame();
                else if(gameOverScreen.style.display !== 'none') restartGame();
                return;
            }
            if (!isPlaying) return;
            
            if (e.key.toLowerCase() === 'a') {
                if (currentMode === 'A_ONLY') attemptAttack(mouse.x, mouse.y, true);
                else if (currentMode === 'A_LEFT') aKeyPrimed = true; 
            }
            else if (e.key.toLowerCase() === 's') {
                player.isMoving = false;
                player.destX = player.x;
                player.destY = player.y;
                aKeyPrimed = false; 
                createFeedback(player.x, player.y + 20, "STOP", "#ffffff");
            }
        });

        canvas.addEventListener('mousedown', (e) => {
            if (!isPlaying) return;
            updateMousePos(e); 

            if (e.button === 0 && currentMode === 'A_LEFT' && aKeyPrimed) {
                attemptAttack(mouse.x, mouse.y, true);
                aKeyPrimed = false;
            } 
            else if (e.button === 2) { 
                aKeyPrimed = false; 
                let isAttack = false;
                
                for(let i=0; i<enemies.length; i++) {
                    if(Math.hypot(mouse.x - enemies[i].x, mouse.y - enemies[i].y) <= enemies[i].radius + 40) {
                        isAttack = true; break;
                    }
                }

                if ((currentMode === 'RIGHT' || currentMode === 'A_LEFT') && isAttack) {
                    attemptAttack(mouse.x, mouse.y, false); 
                } else {
                    player.destX = mouse.x; player.destY = mouse.y;
                    player.isMoving = true;
                    addClickEffect(mouse.x, mouse.y, '#00ffcc', false);
                }
            }
        });

        function updateTier() {
            let tier = "UNRANKED"; let color = "#888";
            if (totalDamage >= 12000) { tier = "CHALLENGER"; color = "#00ffcc"; } 
            else if (totalDamage >= 9000) { tier = "GRANDMASTER"; color = "#f35588"; } 
            else if (totalDamage >= 7000) { tier = "MASTER"; color = "#d192fd"; } 
            else if (totalDamage >= 5000) { tier = "DIAMOND"; color = "#576bce"; } 
            else if (totalDamage >= 3500) { tier = "EMERALD"; color = "#00d26a"; } 
            else if (totalDamage >= 2500) { tier = "PLATINUM"; color = "#2ec4b6"; } 
            else if (totalDamage >= 1500) { tier = "GOLD"; color = "#ffd700"; } 
            else if (totalDamage >= 800) { tier = "SILVER"; color = "#c0c0c0"; } 
            else if (totalDamage >= 400) { tier = "BRONZE"; color = "#cd7f32"; } 
            else if (totalDamage >= 0) { tier = "IRON"; color = "#5a5a5a"; } 

            tierBadgeEl.innerText = tier; tierBadgeEl.style.color = color; tierBadgeEl.style.borderColor = color;
            return { text: tier, color: color };
        }

        function copyResult() {
            const region = regionSelect.value;
            const id = riotIdInput.value || "ìµëª…";
            const tier = tierBadgeEl.innerText;
            const text = `[ë¡¤ í”¼ì§€ì»¬ íŠ¸ë ˆì´ë„ˆ - ì¹´ì´íŒ… ìƒì¡´]\në‹¹ì‹ ì˜ ì¹´ì´íŒ… í‹°ì–´ëŠ”?\ní‹°ì–´: ${tier}\nëˆ„ì  ë”œëŸ‰: ${totalDamage} (ìƒì¡´: ${survivalTime.toFixed(1)}ì´ˆ)\ní”Œë ˆì´ì–´: [${region}] ${id}\n\në„ì „í•˜ê¸°: https://lolphysical.xyz/kiting.html`;
            navigator.clipboard.writeText(text).then(() => { alert("ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! íŒ©íŠ¸ í­ê²©ì„ ë‚ ë ¤ë³´ì„¸ìš”."); });
        }

        function attemptAttack(targetX, targetY, isAClick) {
            const now = Date.now();
            if (now - lastAttackTime < attackCooldown) {
                createFeedback(player.x, player.y - 30, "í‰íƒ€ ì¿¨!", "#ffaa00"); return;
            }

            let targetEnemy = null; let minDist = Infinity;
            let hitRadiusBonus = isAClick ? 120 : 40; 

            for (let i = 0; i < enemies.length; i++) {
                let distToMouse = Math.hypot(targetX - enemies[i].x, targetY - enemies[i].y);
                if (distToMouse <= enemies[i].radius + hitRadiusBonus && distToMouse < minDist) {
                    minDist = distToMouse; targetEnemy = enemies[i];
                }
            }

            if (targetEnemy) {
                let distPlayerToEnemy = Math.hypot(player.x - targetEnemy.x, player.y - targetEnemy.y);
                if (distPlayerToEnemy <= player.attackRange) {
                    player.isMoving = false; player.destX = player.x; player.destY = player.y;
                    let damage = Math.floor(80 + Math.random() * 40); 
                    totalDamage += damage; lastAttackTime = now;
                    addClickEffect(targetEnemy.x, targetEnemy.y, '#ff3366', false);
                    createFeedback(targetEnemy.x, targetEnemy.y - 20, "-" + damage, "#ff3366");
                    targetEnemy.hp -= damage;
                    targetEnemy.x += (targetEnemy.x - player.x) * 0.05; targetEnemy.y += (targetEnemy.y - player.y) * 0.05;
                    updateUI(); updateTier(); 
                } else {
                    player.destX = targetEnemy.x; player.destY = targetEnemy.y; player.isMoving = true;
                    addClickEffect(targetEnemy.x, targetEnemy.y, '#ffaa00', false);
                }
            } else {
                player.destX = targetX; player.destY = targetY; player.isMoving = true;
                addClickEffect(targetX, targetY, isAClick ? '#ff3333' : '#00ffcc', false);
            }
        }

        function spawnEnemy(timeSec) {
            let maxE = Math.min(5, 1 + Math.floor(timeSec / 10)); 
            if (enemies.length < maxE) {
                let angle = Math.random() * Math.PI * 2;
                let ex = player.x + Math.cos(angle) * 600; let ey = player.y + Math.sin(angle) * 600;
                let type = (timeSec > 10 && Math.random() > 0.6) ? 'MAGE' : 'MELEE';
                enemies.push({ id: Math.random(), type: type, x: ex, y: ey, radius: type === 'MAGE' ? 18 : 22, hp: type === 'MAGE' ? 300 : 500, maxHp: type === 'MAGE' ? 300 : 500, speed: type === 'MAGE' ? 1.5 : 2.6, state: 'CHASE', timer: 0 });
            }
        }

        function gameOver() {
            isPlaying = false;
            if (totalDamage > bestDamage) { bestDamage = totalDamage; localStorage.setItem('lol_best_damage_kiting', bestDamage); bestDamageEl.innerText = bestDamage; }
            ctx.fillStyle = 'rgba(0, 0, 0, 0.85)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            const tierInfo = updateTier();
            document.getElementById('resultId').innerText = `[${regionSelect.value}] ${riotIdInput.value || "ìµëª…"}`;
            document.getElementById('resultDamage').innerText = totalDamage;
            document.getElementById('resultTime').innerText = survivalTime.toFixed(1);
            const resTier = document.getElementById('resultTier');
            resTier.innerText = tierInfo.text; resTier.style.color = tierInfo.color;
            gameOverScreen.style.display = 'inline-block';
        }

        function addClickEffect(x, y, color, isBlast) { clickEffects.push({ x, y, color, radius: isBlast ? 30 : 0, alpha: isBlast ? 0.8 : 1.0, isBlast: isBlast }); }
        function createFeedback(x, y, text, color) { hitFeedback.push({ x, y, text, color, life: 1.0 }); }

        function startGame() {
            const idVal = riotIdInput.value.trim(); const regionVal = regionSelect.value; currentMode = modeSelect.value;
            if(idVal) localStorage.setItem('lol_name', idVal);
            localStorage.setItem('lol_server', regionVal); localStorage.setItem('lol_kiting_mode', currentMode);

            startScreen.style.display = 'none'; gameOverScreen.style.display = 'none';
            totalDamage = 0; startTime = Date.now(); survivalTime = 0; lastAttackTime = 0; aKeyPrimed = false;
            player.x = 450; player.y = 300; player.isMoving = false;
            enemies = []; aoeAttacks = []; clickEffects = []; hitFeedback = [];
            isPlaying = true; updateUI(); updateTier(); loop();
        }

        function restartGame() { startGame(); }
        function updateUI() { damageEl.innerText = totalDamage; timeEl.innerText = survivalTime.toFixed(1); }

        function loop() {
            if (!isPlaying) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const now = Date.now(); survivalTime = (now - startTime) / 1000; updateUI();

            if (player.isMoving) {
                const dx = player.destX - player.x; const dy = player.destY - player.y; const dist = Math.hypot(dx, dy);
                if (dist > player.speed) { player.x += (dx / dist) * player.speed; player.y += (dy / dist) * player.speed; } 
                else { player.x = player.destX; player.y = player.destY; player.isMoving = false; }
                player.x = Math.max(player.radius, Math.min(player.x, canvas.width - player.radius));
                player.y = Math.max(player.radius, Math.min(player.y, canvas.height - player.radius));
            }

            spawnEnemy(survivalTime);
            
            for (let i = enemies.length - 1; i >= 0; i--) {
                let e = enemies[i];
                if (e.hp <= 0) { createFeedback(e.x, e.y, "+KILL", "#fff"); enemies.splice(i, 1); continue; }
                let distToPlayer = Math.hypot(player.x - e.x, player.y - e.y);
                if (distToPlayer < player.radius + e.radius - 5) { addClickEffect(player.x, player.y, '#ff0000', true); gameOver(); return; }

                if (e.type === 'MELEE') { e.x += ((player.x - e.x) / distToPlayer) * e.speed; e.y += ((player.y - e.y) / distToPlayer) * e.speed; } 
                else if (e.type === 'MAGE') {
                    if (e.state === 'CHASE') {
                        if (distToPlayer > 350) { e.x += ((player.x - e.x) / distToPlayer) * e.speed; e.y += ((player.y - e.y) / distToPlayer) * e.speed; } 
                        else {
                            e.state = 'CHARGE'; e.timer = now;
                            if (Math.random() > 0.5) aoeAttacks.push({ type: 'CIRCLE', x: player.x, y: player.y, radius: 45, timer: now, delay: 800 });
                            else { let angle = Math.atan2(player.y - e.y, player.x - e.x); aoeAttacks.push({ type: 'LINE', startX: e.x, startY: e.y, angle: angle, width: 60, length: 1000, timer: now, delay: 800 }); }
                        }
                    } else if (e.state === 'CHARGE') { if (now - e.timer > 800) { e.state = 'COOLDOWN'; e.timer = now; } } 
                    else if (e.state === 'COOLDOWN') { if (now - e.timer > 2000) e.state = 'CHASE'; }
                }
            }

            for (let i = aoeAttacks.length - 1; i >= 0; i--) {
                let aoe = aoeAttacks[i];
                if (now - aoe.timer >= aoe.delay) {
                    let hit = false;
                    if (aoe.type === 'CIRCLE') {
                        if (Math.hypot(player.x - aoe.x, player.y - aoe.y) < player.radius + aoe.radius - 5) hit = true;
                        addClickEffect(aoe.x, aoe.y, '#ff3333', true); 
                    } 
                    else if (aoe.type === 'LINE') {
                        let dx = player.x - aoe.startX; let dy = player.y - aoe.startY;
                        let cos = Math.cos(-aoe.angle); let sin = Math.sin(-aoe.angle);
                        let localX = dx * cos - dy * sin; let localY = dx * sin + dy * cos;
                        if (localX >= 0 && localX <= aoe.length && Math.abs(localY) <= (aoe.width / 2) + player.radius - 5) hit = true;
                    }
                    if (hit) { addClickEffect(player.x, player.y, '#ff0000', true); gameOver(); return; }
                    aoeAttacks.splice(i, 1);
                }
            }

            for (let aoe of aoeAttacks) {
                let progress = (now - aoe.timer) / aoe.delay;
                if (aoe.type === 'CIRCLE') {
                    ctx.beginPath(); ctx.arc(aoe.x, aoe.y, aoe.radius, 0, Math.PI * 2); ctx.fillStyle = 'rgba(255, 0, 0, 0.1)'; ctx.fill(); ctx.lineWidth = 2; ctx.strokeStyle = 'rgba(255, 51, 51, 0.6)'; ctx.stroke();
                    ctx.beginPath(); ctx.arc(aoe.x, aoe.y, aoe.radius * progress, 0, Math.PI * 2); ctx.fillStyle = 'rgba(255, 51, 51, 0.3)'; ctx.fill();
                } 
                else if (aoe.type === 'LINE') {
                    ctx.save(); ctx.translate(aoe.startX, aoe.startY); ctx.rotate(aoe.angle);
                    ctx.beginPath(); ctx.rect(0, -aoe.width/2, aoe.length, aoe.width); ctx.fillStyle = 'rgba(255, 0, 0, 0.05)'; ctx.fill(); ctx.lineWidth = 2; ctx.strokeStyle = 'rgba(255, 51, 51, 0.6)'; ctx.stroke();
                    ctx.beginPath(); ctx.rect(0, -aoe.width/2, aoe.length * progress, aoe.width); ctx.fillStyle = 'rgba(255, 51, 51, 0.3)'; ctx.fill(); ctx.restore();
                }
            }

            for (let i = clickEffects.length - 1; i >= 0; i--) {
                let eff = clickEffects[i]; ctx.beginPath(); ctx.arc(eff.x, eff.y, eff.radius, 0, Math.PI * 2);
                if (eff.isBlast) { ctx.fillStyle = eff.color; ctx.globalAlpha = eff.alpha; ctx.fill(); eff.radius += 2; eff.alpha -= 0.08; } 
                else { ctx.strokeStyle = eff.color; ctx.globalAlpha = eff.alpha; ctx.lineWidth = 2; ctx.stroke(); eff.radius += 1.5; eff.alpha -= 0.05; }
                ctx.globalAlpha = 1.0; if (eff.alpha <= 0) clickEffects.splice(i, 1);
            }

            ctx.beginPath(); ctx.arc(player.x, player.y, player.attackRange, 0, Math.PI * 2); ctx.strokeStyle = 'rgba(255, 255, 255, 0.08)'; ctx.lineWidth = 1; ctx.stroke();

            for (let e of enemies) {
                ctx.beginPath(); ctx.arc(e.x, e.y, e.radius, 0, Math.PI * 2); ctx.fillStyle = '#111'; ctx.fill(); ctx.lineWidth = 3; ctx.strokeStyle = e.type === 'MELEE' ? '#ff9900' : '#dd22ff'; ctx.stroke();
                let hpRatio = e.hp / e.maxHp; ctx.fillStyle = '#ff3333'; ctx.fillRect(e.x - 15, e.y - e.radius - 12, 30 * hpRatio, 4);
            }

            ctx.beginPath(); ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2); ctx.fillStyle = '#111'; ctx.fill(); ctx.lineWidth = 3; ctx.strokeStyle = '#00ffcc'; ctx.stroke();

            if (now - lastAttackTime < attackCooldown) {
                const coolRatio = (now - lastAttackTime) / attackCooldown;
                ctx.beginPath(); ctx.arc(player.x, player.y, player.radius + 6, -Math.PI/2, (-Math.PI/2) + (Math.PI * 2 * coolRatio)); ctx.strokeStyle = '#ffee00'; ctx.lineWidth = 3; ctx.stroke();
            }

            if (aKeyPrimed) {
                ctx.beginPath(); ctx.arc(mouse.x, mouse.y, 15, 0, Math.PI * 2); ctx.strokeStyle = '#ff3333'; ctx.lineWidth = 2; ctx.stroke();
                ctx.beginPath(); ctx.moveTo(mouse.x - 20, mouse.y); ctx.lineTo(mouse.x + 20, mouse.y);
                ctx.moveTo(mouse.x, mouse.y - 20); ctx.lineTo(mouse.x, mouse.y + 20);
                ctx.strokeStyle = '#ff3333'; ctx.lineWidth = 1; ctx.stroke();
            }

            for (let i = hitFeedback.length - 1; i >= 0; i--) {
                let fb = hitFeedback[i]; ctx.fillStyle = fb.color; ctx.globalAlpha = fb.life; ctx.font = 'bold 20px sans-serif'; ctx.textAlign = 'center'; ctx.fillText(fb.text, fb.x, fb.y - (1 - fb.life) * 40); ctx.globalAlpha = 1.0;
                fb.life -= 0.02; if (fb.life <= 0) hitFeedback.splice(i, 1);
            }

            requestAnimationFrame(loop);
        }

        const articleListEl = document.getElementById('articleList');
        if (typeof articles !== 'undefined') {
            articles.forEach(article => {
                const li = document.createElement('li');
                li.innerHTML = `<a href="${article.link}" target="_blank">${article.title}</a><span class="badge-ready">${article.status}</span>`;
                articleListEl.appendChild(li);
            });
        }
    </script>
</body>
</html>